package main

import (
	"testing"
)

// extracted from capture from SSL labs against mitm.watch (empty SID, two
// cipher suites, SNI).
var clientHelloRecord = []byte{
	0x16, 0x03, 0x02, 0x00, 0x44, 0x01, 0x00, 0x00, 0x40, 0x03, 0x02, 0x5a, 0x1c, 0x60, 0xa5, 0x3d,
	0x18, 0xc4, 0x33, 0x17, 0x7c, 0x60, 0xf6, 0xfb, 0x0a, 0xf3, 0x8a, 0x8b, 0x02, 0x4f, 0xc1, 0x1d,
	0x0d, 0x0a, 0x62, 0x9a, 0x57, 0x30, 0x2f, 0xdf, 0xe4, 0x95, 0x08, 0x00, 0x00, 0x04, 0x00, 0x2f,
	0x00, 0xff, 0x01, 0x00, 0x00, 0x13, 0x00, 0x00, 0x00, 0x0f, 0x00, 0x0d, 0x00, 0x00, 0x0a, 0x6d,
	0x69, 0x74, 0x6d, 0x2e, 0x77, 0x61, 0x74, 0x63, 0x68,
}

func TestClientHelloParser(t *testing.T) {
	sni := parseClientHello(clientHelloRecord)
	expectedSni := "mitm.watch"
	if expectedSni != sni {
		t.Errorf("expected %v, got %v", expectedSni, sni)
	}
}
